<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Shared WASM Counter</title>
    <style>
        body { font-family: sans-serif; text-align: center; padding: 50px; }
        #count { font-size: 4em; font-weight: bold; color: #333; }
        button { padding: 10px 20px; font-size: 1.2em; cursor: pointer; }
        .status { color: #666; margin-top: 20px; }
    </style>
</head>
<body>

    <h1>SharedWorker WASM State</h1>
    <div id="count">...</div>
    <br>
    <button id="btn">Increment via WASM</button>
    <div class="status">Open this page in a second tab to see the magic.</div>

    <script>
        const display = document.getElementById('count');
        const btn = document.getElementById('btn');
        
        // Connect to the specific worker file
        const worker = new SharedWorker('worker.js');

        // Listen for broadcasts from the worker
        worker.port.onmessage = (e) => {
            if (e.data.type === 'UPDATE') {
                display.innerText = e.data.value;
                console.log("Updated by SharedWorker");
            }
        };

        worker.port.start();

        // Send command to worker
        btn.onclick = () => {
            worker.port.postMessage("INCREMENT");
        };
    </script>
</body>
</html>